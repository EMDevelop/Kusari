version: 1
frontend:
  phases:
    preBuild:
      commands:
        - pip3 install -U pipenv
        - pipenv install django
        - pipenv install djangorestframework
        - pipenv install django-cors-headers
        - pipenv install requests
        - pipenv install django-dotenv
        - pipenv install pytest
        - pipenv shell
        - cd frontend
        - npm install
        - cd ..
    build:
      commands:
        - npm run client
        - npm run server
  backend:
    phases:
      postBuild:
        commands:
          - python manage.py migrate
  artifacts:
    baseDirectory: frontend/build
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
